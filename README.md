# Project Overview

This repository contains all the source code and data generated for the PhD thesis: J. Pober, "Towards Neuro-Symbolic Symbol Grounding", PhD Thesis, King's College London, UK 2025. 

## Directory Structure

| Directory | Description |
|-----------|------------|
| `/.idea/` | Miscellaneous project, and git, files. |
| `/data/` | All the data generated by me for my experiments. Black-and-white images of size 28Ã—28, featuring simple shapes (circle, square, triangle) at different positions within the image. Divided into different types of data, used for different experiments. |
| `/data/backup/` | Backups of various datasets explained below. |
| `/data/inter/` | This directory features the input data used for the majority of my experiments. It consists of a variety of data sets, featuring images that *inter*polate the position of the depicted shapes. Overall, it features all possible combinations of shapes and positions, and specific subsets of possible combinations. |
| `/data/experiments/` | This directory features the output data produced by the majority of my experiments. It consists of feature representations of input images (in `./imgs/`) created by a traditional autoencoder in `./decodings/`, and by our property autoencoder, in `./encodings/`. |
| `/data/inter/circle/` | Images of a circle moving from the left side of the image to the right side of the image, while its y-position stays fixed. The directory is subdivided into three directories: `centre`, `down`, and `up`, indicating y-position of the moving shape. |
| `/data/inter/custom/` | Directory used to store custom generated data, frequently overwritten depending on which experiment is performed. Currently holds images of a circle in all possible positions. |
| `/data/inter/custom-CIRCLE/` | Similar to `/data/inter/custom`, except it only holds variations of circles. |
| `/data/inter/custom_mixed/` | All possible shapes, in all possible positions. |
| `/data/inter/custom_square_circle/` | The same as `/data/inter/custom_mixed`, except without triangles. |
| `/data/inter/square/` | Identical to `/data/inter/circle`, except it uses squares instead of circles. |
| `/data/inter/square_triangle/` | The same as `/data/inter/custom_mixed`, except without circles. |
| `/data/inter/triangle/` | Identical to `/data/inter/circle`, except it uses triangles instead of circles. |
| `/data/left/` | A series of images depicting a circle moving up and down, while touching the left side of the image. |
| `/data/pairs/` | Data used in earlier experiments. Consists of `data pairs,` showing an image of a shape, and then a second image depicting the same shape but at a shifted position. This was done to observe difference in neural activity depending on input, and trying to isolate specific neurons encoding this shift in position. The original images are stored in `/data/pairs/1`, and the same image, with the shape moved to different position, in `/data/pairs/2`. The images in each subdirectory follow the naming convention `i.d.s.png`, where `i` is the index of the image, `d` indicates the direction it was moved in (`u` up, `d` down, `r` right, `l` left), and `s` is the amount it was moved by in pixels. |
| `/data/right/` | A series of images depicting a circle moving up and down, while touching the right side of the image. |
| `/data/simple/` | Data used in earlier experiments. Consists entirely of circles at different positions. Used only for the preliminary experiments. |
| `/histories/` | Holds the training history of the last model that was run. |
| `/logs/` | Stores the logs generated by the machine learning packages. |
| `/models/` | Holds all models. Includes multiple different naming conventions, as we had to become more specific over time. The most general convention (the one that the other conventions are subsets of) is `t.x_i-c-e`, where `t` is the type of model it is (either AE for autoencoder, or PAE for property-autoencoder), `x` is the name of the experiment it was used in, `i` is the dimension of the input, `c` is the dimensionality of the feature vector produced by this model, and `e` are the amount of epochs used to train this model. |




## Source Code Structure

| File | Description |
|------|------------|
| `aes.py` | Holds all versions of traditional autoencoders used. |
| `comparer.py` | An early, deprecated attempt at learning properties through the explicit use of comparison-based training methods. |
| `data.py` | Data-related helper functions, such as automatic generation of labels, assigning `data pairs,` as described above for the `/data/pairs` directory. Additionally, handles processing, shuffling, and loading of data. |
| `data_main.py` | The file that manages the generation of data when run. |
| `directories.py` | Stores all directories to important external files as variables, such as models, data, training histories, etc. |
| `exp_propertyAE.py` | The property autoencoder, and variations thereof. Used for many different experiments, in different configurations. |
| `exp_splitNN.py` | Similarly deprecated to `comparer.py`. Served as a more concrete, early prototype for `exp_propertyAE.py`. |
| `exp_supervised_xy.py` | A proto property autoencoder, used to test the viability of learning properties from feature vectors in a supervised setting. |
| `generator.py` | High-level data generator. Manages the generation of data sets for specific experiments. |
| `helper.py` | Deprecated helper file. |
| `main.py` | Main file through which to set up and run all experiments. |
| `nn.py` | Deprecated, generic neural network model. |
| `shapes.py` | Low-level data generator. Manages the actual drawing of shapes in images. |
| `split_nn.py` | A different variation of `exp_splitNN.py`, and similarly deprecated. It has slightly tweaked parameters and architectures, such as utilizing convolutional layers for image preprocessing. |
| `test.py` | A miscellaneous file to quickly test different parameter configurations for experiments. |
| `vis.py` | Helper functions to visualize experiments, training histories, model structures, and neural activations. |
| `vis_main.py` | Manages the visualization process and calls helper visualization functions from `vis.py`. |


## Usage

Run `main.py` to set up and execute experiments. Data generation is managed by `data_main.py`.

